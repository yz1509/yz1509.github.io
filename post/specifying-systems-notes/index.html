<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Specifying Systems Notes - HTT - ふわふわ時間</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="765PRO.P" />
  <meta name="description" content="《Specifying Systems》 阅读笔记。
" />

  <meta name="keywords" content="K-ON, KyoAni" />






<meta name="generator" content="Hugo 0.76.0-DEV" />


<link rel="canonical" href="https://k-on.me/post/specifying-systems-notes/" />







<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">








<link rel="stylesheet" href="/sass/jane.min.b3a8813c06e6d785beba22bf8264e174fa2cb3a396b22f9ba24e2c00c18aaf7f.css" integrity="sha256-s6iBPAbm14W&#43;uiK/gmThdPoss6OWsi&#43;bok4sAMGKr38=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="Specifying Systems Notes" />
<meta property="og:description" content="《Specifying Systems》 阅读笔记。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://k-on.me/post/specifying-systems-notes/" />
<meta property="article:published_time" content="2020-12-08T10:23:40+08:00" />
<meta property="article:modified_time" content="2020-12-08T10:23:40+08:00" />
<meta itemprop="name" content="Specifying Systems Notes">
<meta itemprop="description" content="《Specifying Systems》 阅读笔记。">
<meta itemprop="datePublished" content="2020-12-08T10:23:40+08:00" />
<meta itemprop="dateModified" content="2020-12-08T10:23:40+08:00" />
<meta itemprop="wordCount" content="5186">



<meta itemprop="keywords" content="TLA&#43;," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Specifying Systems Notes"/>
<meta name="twitter:description" content="《Specifying Systems》 阅读笔记。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">HTT</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/about/">About</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/categories/">Categories</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      HTT
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/about/">About</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://k-on.me/categories/">Categories</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Specifying Systems Notes</h1>
      
      <div class="post-meta">
        <time datetime="2020-12-08" class="post-time">
          2020-12-08
        </time>
        <div class="post-category">
            <a href="https://k-on.me/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"> 分布式 </a>
            
          </div>
        <span class="more-meta"> 5186 words </span>
          <span class="more-meta"> 11 min read </span>

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#chapter-1-a-little-simple-math">Chapter 1: A Little Simple Math</a>
      <ul>
        <li><a href="#propositional-logic">Propositional Logic</a></li>
        <li><a href="#predicate-logic">Predicate Logic</a></li>
      </ul>
    </li>
    <li><a href="#chapter-2-specifying-a-simple-clock">Chapter 2: Specifying a Simple Clock</a>
      <ul>
        <li><a href="#小结">小结</a></li>
      </ul>
    </li>
    <li><a href="#chapter-3-an-asynchronous-interface">Chapter 3: An Asynchronous Interface</a>
      <ul>
        <li><a href="#invariant--type">Invariant &amp; Type</a></li>
        <li><a href="#record">Record</a></li>
        <li><a href="#definitions">Definitions</a></li>
        <li><a href="#comments">Comments</a></li>
        <li><a href="#小结-1">小结</a></li>
      </ul>
    </li>
    <li><a href="#chapter-4-a-fifo">Chapter 4: A FIFO</a>
      <ul>
        <li><a href="#instantiation-examined">Instantiation Examined</a></li>
        <li><a href="#hiding-variables">Hiding variables</a></li>
        <li><a href="#assume">ASSUME</a></li>
        <li><a href="#小结-2">小结</a></li>
      </ul>
    </li>
    <li><a href="#chapter-5-a-caching-memory">Chapter 5: A Caching Memory</a>
      <ul>
        <li><a href="#parameters">Parameters</a></li>
        <li><a href="#functions">Functions</a></li>
        <li><a href="#invariance">Invariance</a></li>
        <li><a href="#小结-3">小结</a></li>
      </ul>
    </li>
    <li><a href="#chapter-6-some-more-math">Chapter 6: Some More Math</a>
      <ul>
        <li><a href="#sets">Sets</a></li>
        <li><a href="#silly-expressions">Silly Expressions</a></li>
        <li><a href="#functions-versus-operators">Functions versus Operators</a></li>
      </ul>
    </li>
    <li><a href="#chapter-7-writing-a-specification-some-advice">Chapter 7: Writing a Specification: Some Advice</a></li>
    <li><a href="#chapter-8-liveness-and-fairness">Chapter 8: Liveness and Fairness</a>
      <ul>
        <li><a href="#temporal-formulas">Temporal Formulas</a></li>
        <li><a href="#temporal-tautologies">Temporal Tautologies</a></li>
        <li><a href="#temporal-proof-rules">Temporal Proof Rules</a></li>
        <li><a href="#weak-fairness">Weak Fairness</a></li>
      </ul>
    </li>
    <li><a href="#chapter-x-the-standard-modules">Chapter X: The Standard Modules</a>
      <ul>
        <li><a href="#sequences-module">Sequences Module</a></li>
        <li><a href="#finitesets-module">FiniteSets Module</a></li>
        <li><a href="#bags-module">Bags Module</a></li>
        <li><a href="#the-numbers-modules">The Numbers Modules</a></li>
        <li><a href="#realtime-module">RealTime Module</a></li>
        <li><a href="#tlc-module">TLC Module</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p><a href="http://lamport.azurewebsites.net/tla/book-02-08-08.pdf">《Specifying Systems》</a> 阅读笔记。</p>
<hr>
<h2 id="chapter-1-a-little-simple-math">Chapter 1: A Little Simple Math</h2>
<h3 id="propositional-logic">Propositional Logic</h3>
<p><a href="https://en.wikipedia.org/wiki/Propositional_calculus">Propositional Logic</a> (命题逻辑) is the mathematics of the two Boolean values <code>TRUE</code> and <code>FALSE</code> and the five operators whose names are:</p>
<ul>
<li>$\land$ conjunction (and)</li>
<li>$\lor$ disjunction (or)</li>
<li>$\lnot$ negation (not)</li>
<li>$\Rightarrow$ implication (implies)</li>
<li>$\equiv$ equivalence (is equivalent to)</li>
</ul>
<p><a href="https://en.wikipedia.org/wiki/Tautology_(logic)">Tautology</a> (恒真式) is a formula or assertion that is ture in every possible interpretation. 比如 $F \Rightarrow G \equiv \lnot F \lor G$ 是一个 tautology。</p>
<h3 id="predicate-logic">Predicate Logic</h3>
<p><a href="https://en.wikipedia.org/wiki/First-order_logic">Predicate Logic</a> (谓词逻辑) extends propositional logic with the two quantifiers:</p>
<ul>
<li>$\forall$ universal quantification (for all)</li>
<li>$\exists$ existential quantification (there exists)</li>
</ul>
<p>其中，<a href="https://en.wikipedia.org/wiki/Predicate_(mathematical_logic)">Predicate</a> 可以看作为一个布尔值函数，而 <a href="https://en.wikipedia.org/wiki/Quantifier_(logic)">quantifiers</a> 指定了该 predicate 成立的程度。</p>
<h2 id="chapter-2-specifying-a-simple-clock">Chapter 2: Specifying a Simple Clock</h2>
<ul>
<li><strong>state</strong>: an assignment of values to varibles.</li>
<li><strong>behavior</strong> is an infinite sequence of states.</li>
<li><strong>step</strong>: a pair of successive states.</li>
<li><strong>action</strong>: an action is a formula, is true or false of a step.
<ul>
<li>A step is satisfies the action $A$ is called an $A$ step</li>
<li>An action is a formula, and formulas aren&rsquo;t executed</li>
</ul>
</li>
<li><strong>stuttering steps</strong>: steps that leave specified state unchanged.</li>
<li><strong>theorem</strong>: a temporal formula satisfied by every behavior is called a theorem.</li>
</ul>
<h3 id="小结">小结</h3>
<p>在本章中作者通过简单的 Clock 例子展示了使用 TLA+ 描述一个系统时的大致流程：</p>
<ol>
<li>先给出系统初始状态 $Init$</li>
<li>再描述系统状态变化的行为 $Next$</li>
<li>然后，得到 $Spec \triangleq Init \land \Box [Next]_{vars}$</li>
<li>最后给出系统应满足的条件：$\mathrm{THEOREM} \enspace Spec \Rightarrow \mathrm{Temporal \enspace formula}$</li>
</ol>
<h2 id="chapter-3-an-asynchronous-interface">Chapter 3: An Asynchronous Interface</h2>
<h3 id="invariant--type">Invariant &amp; Type</h3>
<ul>
<li>A <strong>state function</strong> is an ordinary expression (one with no prime or $\Box$) that can contain variables and constants.</li>
<li>A <strong>state predicate</strong> is a Boolean-valued state function. (one with no prime or $\Box$)</li>
<li>An <strong>invariant</strong> $Inv$ of a specification $Spec$ is a state predicate such that $Spec \Rightarrow \Box Inv$ is a theorem.</li>
<li>A variable $v$ has <strong>type</strong> $T$ in a specification $Spec$ iff $v \in T$ is an invariant of $Spec$.</li>
<li>PS: TLA+ is an untyped language. Type correctness is just a name for a certain invariance property.</li>
</ul>
<h3 id="record">Record</h3>
<ul>
<li>
<p>A <strong>record</strong> is a function whose domain is a finite set of strings.</p>
<ul>
<li>
<p>eg. $[val \mapsto d, ack \mapsto 1, rdy \mapsto 0]$ can be written</p>
<p>$[i \in \lbrace &ldquo;val&rdquo;, &ldquo;ack&rdquo;, &ldquo;rdy&rdquo;\rbrace \mapsto $
$$\mathrm{IF} \enspace i = &ldquo;val&rdquo; \enspace \mathrm{THEN} \enspace  d \enspace  \mathrm{ELSE \enspace IF} \enspace i = &ldquo;ack&rdquo; \enspace \mathrm{THEN} \enspace 1 \enspace \mathrm{ELSE} \enspace 0]$$</p>
</li>
<li>
<p>The set of records is written: $[val : Data, rdy : \{0, 1\}, ack : \{0, 1\}]$</p>
</li>
<li>
<p>The fields of a record are not ordered</p>
</li>
</ul>
</li>
<li>
<p>In general, for any record $r$, the expression $[r \enspace \mathrm{EXCEPT} \enspace !.c_1 = e_1, \cdots , !.c_n = e_n]$ is the record obtained from $r$ by replacing $r.c_i$ with $e_i$, for each $i$ in $1 .. n$.</p>
<ul>
<li><code>!</code> as standing for the new record $r'$</li>
<li>an <code>@</code> in the expression $e_i$ stands for $r.c_i$</li>
</ul>
</li>
</ul>
<h3 id="definitions">Definitions</h3>
<ul>
<li>
<p><strong>operators</strong>: We define operators that take <em>more than one argument</em> in the obvious way, the general form being</p>
<p>$$Id(p_1, \dots, p_n) \triangleq exp$$</p>
<p>where the $p_i$ are distinct identifiers and $exp$ is an expression.</p>
</li>
<li>
<p><strong>symbol</strong>: mean an identifier or an operator.</p>
<ul>
<li>
<p>Every symbol declaration or definition has a <strong>scope</strong> within the symbol may bes used.</p>
</li>
<li>
<p>The statement $\mathrm{EXTENDS}$ extends the scope of symbols</p>
</li>
<li>
<p>A symbol cannot be declared or defined if it already has a meaning.</p>
<p>eg. $\exists v \in S : (exp1 \land \exists v \in T : exp2)$ is illegal.</p>
</li>
</ul>
</li>
</ul>
<h3 id="comments">Comments</h3>
<ul>
<li>单行注释：<code>\*</code></li>
<li>多行注释：<code>(*....*)</code></li>
</ul>
<h3 id="小结-1">小结</h3>
<p>在本章中，作者通过示例展示了在描述一个系统时：</p>
<ol>
<li>可以通过定义 <code>invariant</code> 描述系统该满足的条件，以便于理解，比如 type-correctness invariant</li>
<li>可以使用 <code>record</code> 将多个变量整合为单个变量</li>
</ol>
<h2 id="chapter-4-a-fifo">Chapter 4: A FIFO</h2>
<h3 id="instantiation-examined">Instantiation Examined</h3>
<p><strong>Instantiation Is Substitution</strong></p>
<p>Let&rsquo;s now consider an arbitrary $\mathrm{INSTANCE}$ statement</p>
<p>$$IM \triangleq \mathrm{INTANCE} \enspace M \enspace \mathrm{WITH} \enspace p_1 \leftarrow e_1, \dots, p_n \leftarrow e_n$$</p>
<p>Let $\Sigma$ be a symbol defined in module $M$ and let $d$ be its &ldquo;real&rdquo; definition.</p>
<ul>
<li>The $\mathrm{INSTANCE}$ statement defines $IM!\Sigma$ to have as its real definition the expression obtained from $d$ by replacing all instances of $p_i$ by the expression $e_i$, for each $i$.</li>
<li>The definition of $IM!\Sigma$ must contain only the parameters (declared constants and variables) of the current module, not the ones of module $M$.
<ul>
<li>Hence, the $p_i$ must consist of all the parameters of module $M$.</li>
<li>The $e_i$ must be expressions that are meaningful in the current module.</li>
</ul>
</li>
</ul>
<p><strong>Parametrized Instantiation</strong></p>
<p>$$InChan \triangleq \mathrm{INTSANCE} \enspace Channel \enspace \mathrm{WITH} \enspace Data \leftarrow Message, chan \leftarrow in$$
$$OutChan \triangleq \mathrm{INTSANCE} \enspace Channel \enspace \mathrm{WITH} \enspace Data \leftarrow Message, chan \leftarrow out$$</p>
<p>可以使用参数实例化，将上述两个实例化语句合为一条语句：</p>
<p>$$Chan(ch) \triangleq \mathrm{INTSANCE} \enspace Channel \enspace \mathrm{WITH} \enspace Data \leftarrow Message, chan \leftarrow ch$$</p>
<p>其中 $ch \in \lbrace in, out \rbrace$。</p>
<p><strong>Implicit Substitutions</strong></p>
<p>我们也可以使用当前 module 中的参数替代将要实例化的 module 中同名参数，例如:</p>
<p>$$InChan \triangleq \mathrm{INTSANCE} \enspace Channel \enspace \mathrm{WITH} \enspace Data \leftarrow Data, chan \leftarrow in$$</p>
<p>TLA+ allows us to drop any substiotution of the form $\Sigma \leftarrow \Sigma$, for a symbol $\Sigma$. So, the statement above can be written as</p>
<p>$$InChan \triangleq \mathrm{INTSANCE} \enspace Channel \enspace \mathrm{WITH} \enspace chan \leftarrow in$$</p>
<p>其中，$Data$ 参数会被当前 module 中的 $Data$ 参数隐式替代。特别地，当所有参数都使用隐式替代时，$\mathrm{WITH}$ 语句可以省略。</p>
<p><strong>Instantiation Without Renaming</strong></p>
<p>当同一 module 有多个实例或使用参数实例化时，我们需要使用 $IM!\Sigma$ 重命名 $\Sigma$ 以区分不同的实例。但当该 module 只有一个实例时，我们可以省略重命名，此时，实例化语句可以使用如下格式：</p>
<p>$$\mathrm{INTSANCE} \enspace Channel \enspace \mathrm{WITH} \enspace Data \leftarrow D, chan \leftarrow x$$</p>
<p>This instantiates $Channel$ with no renaming, but with substitution.</p>
<h3 id="hiding-variables">Hiding variables</h3>
<p>In TLA, we hide a variable with the existential quantifier <strong>∃</strong> of temporal logic.</p>
<ul>
<li>In the formula <strong>∃</strong>$x : F$, the symbol $x$ is declared to be a variable in $F$.</li>
<li>Unlike $\exists r : F$, which asserts the existence of a single value $r$, the formula <strong>∃</strong>$x : F$ asserts the exitence of a value for $x$ in each state of a behavior.</li>
</ul>
<p>因此，我们可以通过结合量词 <strong>∃</strong> 和参数实例化的特性达到隐藏变量的目的，例如：</p>
<p>$ Inner(q) \triangleq \mathrm{INSTANCE} \enspace InnerFIFO$</p>
<p>$Spec \triangleq$ <strong>∃</strong> $q : Inner(q)!Spec$</p>
<p>The variable parameter $q$ of module $InnerFIFO$ is instantiated with the parameter $q$ of the definition of $Inner$.</p>
<h3 id="assume">ASSUME</h3>
<ul>
<li>An $\mathrm{ASSUME}$ statement should be used only to make assumptions about <strong>constants</strong></li>
<li>我们不需要假定某个常量是集合类型，because in TLA+, every value is a set.</li>
</ul>
<h3 id="小结-2">小结</h3>
<ol>
<li>介绍了 Instantiation，并展示了如何利用实例化以使用其他 module</li>
<li>通过利用量词 <strong>∃</strong> 和参数实例化的特性可达到隐藏变量的目的</li>
<li>利用 $\mathrm{ASSUME}$ 语句可以设定 $\mathrm{CONSTANT}$ 的取值范围</li>
</ol>
<h2 id="chapter-5-a-caching-memory">Chapter 5: A Caching Memory</h2>
<h3 id="parameters">Parameters</h3>
<ul>
<li>
<p>The way to leave something unspecified in a specification is to make ti a parameter</p>
</li>
<li>
<p>TLA+ provides only $\mathrm{CONSTANCE}$ and $\mathrm{VARIABLE}$ parameters, not action parameters, we can declare a <strong>constant operator</strong> to descirbe the action.</p>
</li>
<li>
<p>In TLA+, we declare $Send$ to be a constant operator that takes four arguments by writing:</p>
<p>$$\mathrm{INSTANCE} \enspace Send(\rule[-0pt]{0.3cm}{0.5pt}， \rule[-0pt]{0.3cm}{0.5pt}， \rule[-0pt]{0.3cm}{0.5pt}， \rule[-0pt]{0.3cm}{0.5pt})$$</p>
</li>
<li>
<p>The expression $\mathrm{CHOOSE} \enspace v : v \notin Val$ equals an arbitrarily chosen value $x$ that satisfies the formula. If no such $x$ exists, the expression has a completely arbitrary value.</p>
</li>
</ul>
<h3 id="functions">Functions</h3>
<ul>
<li>
<p>A function $f$ has a domain, written $\mathrm{DOMAIN} \enspace f$, and it assigns to each element $x$ of its domain the value $f[x]$</p>
</li>
<li>
<p>For any sets $S$ and $T$, the set of all functions whose domain equals $S$ and whose range is any subset of $T$ is written $[S \rightarrow T]$</p>
</li>
<li>
<p>A record is a function whose domain is a finite set of strings</p>
</li>
<li>
<p>In general, $[f \enspace \mathrm{EXCEPT} \enspace ![c_1] = e_1, \dots, ![c_n] = e_n]$ is the function $\hat{f}$ that is the same as $f$ except with $\hat{f}[c_i]= e_i$ for each $i$. More precisely, this expression equals</p>
<p>$$[\dots[[f \enspace \mathrm{EXCEPT} \enspace ![c_1] = e_1]\enspace \mathrm{EXCEPT} \enspace ![c_2] = e_2]\dots \enspace \mathrm{EXCEPT} \enspace ![c_n] = e_n]$$</p>
</li>
<li>
<p>Functions correspond to the arrays of programming languages. A function whose range is a set of functions corresponds to an array of arrays. eg:</p>
<p>$$[f \enspace \mathrm{EXCEPT} \enspace ![c][d] = e]$$</p>
<p>can be written as</p>
<p>$$[f \enspace \mathrm{EXCEPT} \enspace ![c] = [@ \enspace \mathrm{EXCEPT} \enspace ![d] = e]]$$</p>
</li>
<li>
<p>TLA+ uniformly maintains the notation that $\sigma.c$ is an abbreviation for $\sigma[&ldquo;c&rdquo;]$. For example, this implies</p>
<p>$$[f \enspace \mathrm{EXCEPT} \enspace ![c].d = e] = [f \enspace \mathrm{EXCEPT} \enspace ![c][&ldquo;d&rdquo;] = e]$$</p>
</li>
<li>
<p>In TLA+, as in ordinary mathematics, a function of multiple arguments is one whose domain is a set of tuples. For example, $f[5, 3, 1]$ is an abbreviation for $f[\langle 5, 3, 1 \rangle]$, the value of the function $f$ applied to the triple $\langle 5, 3, 1 \rangle$</p>
</li>
<li>
<p>TLA+ provides the Cartesian product operator $\times$ of ordinary mathematics, where $A \times B \times C$ is the set of all 3-tuples $\langle a, b, c \rangle$ such that $a \in A, b \in B$, and $c \in C$.</p>
</li>
<li>
<p>The $\mathrm{LET}$ clause consists of a sequence of definitions whose scope extends until the end of the $\mathrm{IN}$ clause.</p>
</li>
<li>
<p>When writing specifications, we almost always want to specify the new value of a variable $f$ rather than the new values of $f[i]$ for all $i$ in some set.
$$\text{(a)} \space f' = [i \in Nat \mapsto i + 1] \qquad \surd$$
$$\text{(b)} \space \forall i \in Nat : f'[i] = i + 1 \qquad \times$$</p>
<ul>
<li>Formula (a) uniquely determines $f'$, asserting that it&rsquo;s a function with domain $Nat$</li>
<li>Formula (b) is satisfied by lots of different values of $f'$.In fact, wo can&rsquo;t even deduce that $f'$ is a function.</li>
</ul>
</li>
</ul>
<p><strong>Recursive function</strong></p>
<ul>
<li>
<p>Follow definition is illegal because the occurrence of fact to the right of the $\triangleq$ is undefined
$$fact \triangleq [n \in Nat \mapsto \mathrm{IF} \enspace n = 0 \enspace \mathrm{THEN} \enspace 1 \enspace \mathrm{ELSE} \enspace n * fact[n-1]]$$</p>
</li>
<li>
<p>In general, a definition of the form $f[x \in S] \triangleq e$ can be used to define <strong>recursively</strong> a function $f$ with domain $S$.</p>
</li>
<li>
<p>In general, $f[x \in S] \triangleq e$ is an abbreviation for
$$f \triangleq \mathrm{CHOOSE} \enspace f : f = [x \in S \mapsto e]$$</p>
</li>
<li>
<p>TLA+ does not allow mutually recursive definition, but you can convert any mutually recursive definitions into a single recursive definition of a record-valued function whose fields are the desired functions.(P68-69, 6.3)</p>
</li>
</ul>
<h3 id="invariance">Invariance</h3>
<ul>
<li>In general, when $P \land N \Rightarrow P'$ holds, we say that predicate $P$ is an invariant of action $N$</li>
</ul>
<h3 id="小结-3">小结</h3>
<ol>
<li>当不知如何规范化描述某事物时，可先将其看作 parameter</li>
<li>可以利用 $\mathrm{CHOOSE}$ 表示不属于某集合的值</li>
<li>invariant of action $\neq$ invariant of formula</li>
</ol>
<h2 id="chapter-6-some-more-math">Chapter 6: Some More Math</h2>
<h3 id="sets">Sets</h3>
<p><strong>built-in operators of TLA+</strong></p>
<ul>
<li>
<p>The most common operations:</p>
<ul>
<li>intersection $\cap$</li>
<li>union $\cup$</li>
<li>subset $\subseteq$</li>
<li>set difference $\setminus$</li>
</ul>
</li>
<li>
<p>$\mathrm{UNION} \enspace S$: The union of the elements of $S$. For example,
$$\mathrm{UNION} \enspace \lbrace \lbrace 1, 2 \rbrace, \lbrace 2, 3 \rbrace, \lbrace 3, 4 \rbrace \rbrace = \lbrace 1, 2, 3, 4 \rbrace$$</p>
</li>
<li>
<p>$\mathrm{SUBSET} \enspace S$: The set of all subsets of $S$. For example,
$$\mathrm{SUBSET} \enspace \lbrace 1, 2 \rbrace = \lbrace \lbrace \rbrace, \lbrace 1 \rbrace, \lbrace 2 \rbrace, \lbrace 1, 2 \rbrace \rbrace$$</p>
</li>
<li>
<p>$\{x \in S : p\}$: The subset of $S$ consisting of all elements $x$ satisfying property $p$</p>
</li>
<li>
<p>$\{e : x \in S\}$: The set of elements of the form $e$, for all $x$ in the set $S$</p>
</li>
</ul>
<p><strong>Russell&rsquo;s paradox</strong></p>
<p>Let $\mathcal{R}$ be the set of all sets $S$ such that $S \notin S$. The definiton of $\mathcal{R}$ implies that $\mathcal{R} \in \mathcal{R}$ is true iff $\mathcal{R} \notin \mathcal{R}$ is true.</p>
<p>A collection $\mathcal{C}$ is too big to be a set if it is as big as the collection of all sets &mdash; meaning that we can assign to every set a different element of $\mathcal{C}$. That is, $\mathcal{C}$ is too big to be a set if we can define an operator $SMap$ such that</p>
<ul>
<li>$SMap(S)$ is in $\mathcal{C}$, for any set $S$</li>
<li>If $S$ and $T$ are two different sets, then $SMap(S) \neq SMap(T)$</li>
</ul>
<h3 id="silly-expressions">Silly Expressions</h3>
<ul>
<li>TLA+ is based on the usual formalization of mathematics by mathematicians, which doesn&rsquo;t hava types.</li>
<li>A correct formula can contain silly expressions.</li>
</ul>
<h3 id="functions-versus-operators">Functions versus Operators</h3>
<p>$$Tail(s) \triangleq [i \in 1 .. (Len(s) - 1) \mapsto s[i+1]]$$
$$fact[n \in Nat] \triangleq \mathrm{IF} \enspace n = 0 \enspace \mathrm{THEN} \enspace 1 \enspace \mathrm{ELSE} \enspace n*fact[n-1]$$</p>
<ul>
<li>A function like $fact$ by itself is a complete expression that denote a value, but an operator like $Tail$ is not.</li>
<li>Unlike an operator, a function must have a domain, which is a set.</li>
<li>Unlike a function, an operator cannot be defined recursively in TLA+.
<blockquote>
<p>However, we can usually transform an illegal recursive operator definition into a nonrecursive one using a recursive function definition.</p>
</blockquote>
</li>
<li>Operators also differ from functions in that an operator can take an operator as an argument.</li>
<li>The definition of $Tail$ defines $Tail(s)$ for all values of $s$. whatever $Tail(s)$ means, it equals $Tail(s)$. But the definition of $fact$ defines $fact[n]$ only for $n \in Nat$, it tells us nothing about the value of $fact[1/2]$.</li>
<li>TLA+ doesn&rsquo;t permit us to define infix functions</li>
</ul>
<h2 id="chapter-7-writing-a-specification-some-advice">Chapter 7: Writing a Specification: Some Advice</h2>
<ul>
<li>Why Specify?
<ul>
<li>help the design process</li>
<li>consice way of communicating a design</li>
<li>find errors in the design and to help in testing the system</li>
</ul>
</li>
<li>What to Specify?
<ul>
<li>TLA+ is particularly effective at revealing concurrency errors - ones that arise through the interraction of asynchronous components. So when writing a TLA+ specification, you will probably concentrate your efforts on the parts of the system that are most likely to have such errors.</li>
</ul>
</li>
<li>The level of abstraction &mdash; tradeoff of precise and cost
<ul>
<li>The Grain of Atomicity</li>
<li>The Data Structures</li>
</ul>
</li>
<li>Writing the Specification
<ol>
<li>Pick the variables and define the type invariant and initial predicate</li>
<li>Write the next-state action, which forms the bulk of the specification</li>
<li>Write the temporal part of the specification</li>
<li>Assert theorems about the specification</li>
</ol>
</li>
<li>Some Further Hints
<ul>
<li>Don&rsquo;t be too clever, make a specification easy to read</li>
<li>A type invariant is not an assumption, is a property of a specification</li>
<li>Don&rsquo;t be too abstract</li>
<li>Don&rsquo;t assume values that look different are unequal
<ul>
<li>The rules of TLA+ do not imply that $1 \neq &ldquo;a&rdquo;$</li>
</ul>
</li>
<li>Move quantification to the outside</li>
<li>Prime only what you mean to prime
<ul>
<li>PS: you can prime only an expression, not an operator</li>
</ul>
</li>
<li>Write comments as comments</li>
</ul>
</li>
</ul>
<h2 id="chapter-8-liveness-and-fairness">Chapter 8: Liveness and Fairness</h2>
<ul>
<li>Safety properties: waht a system must not do</li>
<li>Liveness properties: something does happen</li>
<li>We express liveness properties as temporal formulas</li>
<li>Liveness properties are likely to be the least important part of your specification</li>
</ul>
<h3 id="temporal-formulas">Temporal Formulas</h3>
<p><strong>Definition</strong></p>
<ul>
<li>A temporal formula is true or false of a $behavior$.</li>
<li>Formally, a temporal formula $F$ assigns a Boolean value, which we write $\sigma \models F$, to a behavior $\sigma$.</li>
<li>We say that $F$ is true of $\sigma$, or that $\sigma$ satisfies $F$, iff $\sigma \models F$ equals $\mathrm{TRUE}$.</li>
</ul>
<p><em>PS: reviews</em></p>
<table>
<thead>
<tr>
<th style="text-align:left">Term</th>
<th style="text-align:left">A formula is true or false of this term</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">state</td>
<td style="text-align:left">state predicate $P$</td>
</tr>
<tr>
<td style="text-align:left">setp</td>
<td style="text-align:left">action $A$</td>
</tr>
<tr>
<td style="text-align:left">behavior</td>
<td style="text-align:left">temporal formula $F$</td>
</tr>
</tbody>
</table>
<p><strong>Unquantified temporal formuals</strong></p>
<p>All the unquantified temporal formulas that we&rsquo;ve seen have been Boolean combinations of three simple kinds of formulas:</p>
<ol>
<li>A $state \ predicate$ $P$, viewed as a temporal formula, is true of a behavior iff it is true in the first state of the behavior.</li>
<li>A formula $\Box P$, where $P$ is a $state \ predicate$, is true of a behavior iff $P$ is true in every state of the behavior</li>
<li>A formula $\Box [N]_v$, where $N$ is an $action$ and $v$ is a state function, is true of a behavior iff every successive pair of steps in the behavior is a $[N]_v$ step.</li>
</ol>
<p>Since a state predicate is an action that contains no primed variables, than
$$\{P, \Box P, \Box [N]_v\} \equiv \{A, \Box A\}$$
where $A$ is an action.</p>
<ul>
<li>We interpret an arbitrary action $A$ as a temporal formula by defining $\sigma \models A$ to be true iff the first two states of $\sigma$ are an $A$ step
<ul>
<li>use the notation $\sigma_i$ that is the $(i+1)^{st}$ state of the behavior $\sigma$, for any natural number $i$, so $\sigma$ is the behavior $\sigma_0 \rightarrow \sigma_1 \rightarrow \sigma_2 \rightarrow \cdots$</li>
<li>That is, $\sigma \models A$ is true iff $\sigma_0 \rightarrow \sigma_1$ is an $A$ step</li>
</ul>
</li>
<li>We defined $\sigma \models \Box A$ to be true iff $\sigma_n \rightarrow \sigma_{n+1}$ is an $A$ step for all $n$. In other words:
$$\sigma \models \Box A \quad \equiv \quad \forall n \in Nat : \sigma^{+n} \models A$$
where $\sigma^{+n} \triangleq \sigma_n \rightarrow \sigma_{n+1} \rightarrow \sigma_{n+2} \rightarrow \cdots$</li>
</ul>
<p>The obvious generalization is</p>
<p>$$\sigma \models \Box F \quad \triangleq \quad \forall n \in Nat : \sigma^{+n} \models F$$</p>
<p>for any temporal formula $F$. In other words, $\sigma$ satisfies $\Box F$ iff every $\sigma^{+n}$ of $\sigma$ satisfies $F$.</p>
<ul>
<li>This defines the meaning of the temporal operator $\Box$. We can therefore read $\Box$ as <em>always</em> or <em>henceforth</em> or <em>from then on</em>.</li>
<li>We say that a formula $F$ is <em>invariant under stuffering</em> iff adding or deleting a stuffering step to a behavior $\sigma$ does not affect whether $\sigma$ satisfies $F$
<ul>
<li>TLA allows you to write only temporal formulas that are invariant under stuttering</li>
<li>A state predicate (viewed as a temporal formula) is invariant under stuttering</li>
<li>In general, the formula $\Box [A]_v$ is invariant under stuttering, for ant action $A$ and state function $v$. However, $\Box A$ is not invariant under stuttering for an arbitrary action $A$</li>
<li>Invariant under stuttering is preserved by $\Box$ and by Boolean operators &mdash; that is, if $F$ and $G$ are invariant under stuttering, then so are $\Box F$, $\lnot F$, $F \land G$, $\forall x \in S : F$, etc.</li>
</ul>
</li>
</ul>
<p><strong>Five especially important classes of formulas</strong></p>
<ul>
<li>
<p>$\Diamond F \quad$ is defined to equal $\lnot \Box \lnot F$. It asserts that $F$ is not always false, which means that $F$ is true at some time</p>
<p>$$\sigma \models \Diamond F \quad \equiv \quad \exists n \in Nat : \sigma^{+n} \models F$$</p>
<p>We usually read $\Diamond$ as <em>eventually</em>, taking eventually to include now.</p>
</li>
<li>
<p>$F \rightsquigarrow G \quad$ is defined to equal $\Box(F \Rightarrow \Diamond G)$. It asserts that whenever $F$ is true, $G$ is eventually true &mdash; that is, $G$ is true then or at some later time.</p>
<p>$\sigma \models (F \rightsquigarrow G) \quad \equiv \quad $
$$\forall n \in Nat : (\sigma^{+n} \models F) \Rightarrow (\exists m \in Nat : (\sigma^{+(n+m)} \models G))$$</p>
<p>We read $\rightsquigarrow$ as <em>leads to</em>.</p>
</li>
<li>
<p>$\Diamond \langle A \rangle_v \quad$ is defined to equal $\lnot \Box [\lnot A]_v$, where $A$ is an action and $v$ is a state function. It asserts that not every step is a $(\lnot A) \lor (v' = v)$ step, so some step is a $A \land (v' \ne v)$ &mdash; that is, an $A$ step that changes $v$. We defines the action $\langle A \rangle_v$ by</p>
<p>$$\langle A \rangle_v \triangleq A \land (v' \ne v)$$</p>
<p>so $\Diamond \langle A \rangle_v$ asserts that eventually $\langle A \rangle_v$ step occurs</p>
</li>
<li>
<p>$\Box \Diamond F \quad$ asserts that at all times, $F$ is true then or at some later time.</p>
<ul>
<li>It asserts that $F$ is <em>infinitely often</em> true (无限但不连续)</li>
<li>In particular, $\Box \Diamond \langle A \rangle_v$ asserts that infinitely many $\langle A \rangle_v$ steps occur</li>
<li>$(\sigma \models \Box \Diamond F) \equiv (\exists_\infty i \in Nat : \sigma^{+i} \models F)$, where $\exists_\infty i \in Nat : P(i)$ means $P(i)$ is true for infinitely many natural numbers $i$</li>
</ul>
</li>
<li>
<p>$\Diamond \Box F \quad$ asserts that eventually (at some time), $F$ becomes true and remains true thereafter.</p>
<ul>
<li>It asserts $F$ is <em>eventually always</em> true (连续)</li>
<li>In particular, $\Diamond \Box [N]_v$ asserts that, eventually, every step is a $[N]_v$ step</li>
</ul>
</li>
</ul>
<h3 id="temporal-tautologies">Temporal Tautologies</h3>
<ul>
<li>A <em>temporal theorem</em> is a temporal formula that is satisfied by all behaviors.</li>
<li>A formula like $\Box F \Rightarrow F$ that is true when any formulas are substituted for its identifiers is called a tautology, tautologies containing temporal operators are sometimes called <em>temporal tautologies</em>.</li>
</ul>
<p><strong>some temporal tautologies</strong></p>
<p>A genneral law: from any temporal tautology, we obtain a dual tautology by making the replacements</p>
<p>$$\Box \leftarrow \Diamond \quad \Diamond \leftarrow \Box \quad \land \leftarrow \lor \quad \lor \leftarrow \land$$</p>
<p>and reversing the direction of all implications. (Any $\equiv$ or $\lnot$ is left unchanged.)</p>
<ol>
<li>
<p>$\lnot \Box F \equiv \Diamond \lnot F$</p>
<ul>
<li>$F$ is not always true iff it is eventually false.</li>
</ul>
</li>
<li>
<p>$\Box(F \land G) \equiv (\Box F) \land (\Box G) \qquad$</p>
<ul>
<li>$F$ and $G$ are both always true iff $F$ is always true and $G$ is always true</li>
<li>$\Box$ distributes over $\land$</li>
</ul>
</li>
<li>
<p>$\Diamond (F \lor G) \equiv (\Diamond F) \lor (\Diamond G)$</p>
<ul>
<li>$F$ or $G$ is eventually true iff $F$ is eventually true or $G$ is eventually true</li>
<li>$\Diamond$ distributes over $\lor$</li>
</ul>
</li>
<li>
<p>$(\Box F) \lor (\Box G) \Rightarrow \Box(F \lor G) \qquad \Diamond (F \land G) \Rightarrow (\Diamond F) \land (\Diamond G)$</p>
<ul>
<li>One can be derived from the derived from the another by substituting $\lnot F$ for $F$ and $\lnot G$ for $G$</li>
</ul>
</li>
<li>
<p>$\Box \Diamond (F \lor G) \equiv (\Box \Diamond F) \lor (\Box \Diamond G) \qquad \Diamond \Box(F \land G) \equiv (\Diamond \Box F) \land (\Diamond \Box G)$</p>
<ul>
<li>$\Box \Diamond$ distributes over $\lor$ and $\Diamond \Box$ distributes over $\land$ (取决于右边的符号)</li>
</ul>
</li>
</ol>
<p>In any TLA tautology, replacing a temporal formula by an action yields a tautology &mdash; a formula that is true for all behaviors &mdash; even if that formula isn&rsquo;t a legal TLA formula. For example, let&rsquo;s substitue $\langle A \rangle_v$ and $\langle B \rangle_v$ for $F$ and $G$ in $5$ to get</p>
<p>$$\Box \Diamond (\langle A \rangle_v \lor \langle B \rangle_v) \quad \equiv \quad (\Box \Diamond \langle A \rangle_v) \lor (\Box \Diamond \langle B \rangle_v)$$</p>
<p>but $(\langle A \rangle_v \lor \langle B \rangle_v)$ isn&rsquo;t a TLA formula (TLA allows you to write only temporal formulas that are invariant under stuttering). We can apply the following rules of logic to transform those nonTLA tautologies into TLA tautologies:</p>
<p>$$[A \land B]_v \quad \equiv \quad [A]_v \land [B]_v \qquad \qquad \langle A \lor B \rangle_v \quad \equiv \quad \langle A \rangle_v \lor \langle B \rangle_v$$</p>
<p>Substituting $\langle A \rangle_v \lor \langle B \rangle_v$ for $\langle A \lor B \rangle_v$, gives us the following TLA tautology:</p>
<p>$$\Box \Diamond \langle A \lor B \rangle_v \quad \equiv \quad (\Box \Diamond \langle A \rangle_v) \lor (\Box \Diamond \langle B \rangle_v)$$</p>
<h3 id="temporal-proof-rules">Temporal Proof Rules</h3>
<p>A <em>proof rule</em> is a rule for deducing true formulas from other true formulas.</p>
<p><strong>Modus Ponens Rule</strong></p>
<ul>
<li>for any formulas $F$ and $G$, if we have proved $F$ and $F \models G$, then we can deduce $G$</li>
<li>the laws of propositional logic hold for temporal logic as well</li>
</ul>
<p><strong>Temporal Proof Rules</strong></p>
<ul>
<li>Modus Ponens Rule</li>
<li>Generalization Rule: From $F$ we can infer $\Box F$, for any temporal formula $F$
<ul>
<li>This rule asserts that, if $F$ is true for all behaviors, then so is $\Box F$</li>
</ul>
</li>
<li>Implies Generalization Rule: From $F \models G$ we can infer $\Box F \models \Box G$, for any temporal formulas $F$ and $G$.
<ul>
<li>The Generalization Rule can be derived from the Implies Generalization Rule.</li>
</ul>
</li>
</ul>
<p><strong>Difference between proof rule and tautology</strong></p>
<ul>
<li>In propositional logic, every proof rule has a corressponding tautology.</li>
<li>In temporal logic, a proof rule need not imply a tautology</li>
</ul>
<h3 id="weak-fairness">Weak Fairness</h3>
<p>When writing liveness properties, the syntax of TLA often forces us to write $\langle A \rangle_v$ instead of $A$, for some action $A$</p>
<blockquote>
<p>Because if $A$ does allow stuttering steps, we want to require not that an $A$ step eventually occurs, but that a nonstuttering $A$ step occurs &mdash; that is, an $\langle A \rangle_v$ step.</p>
</blockquote>
<ul>
<li>
<p>TLA+ defines $\quad \mathrm{ENABLED} \ A \quad$ to be the <em>predicate</em> that is true iff action $A$ is enabled.</p>
</li>
<li>
<p>General liveness condition for an action $A$:</p>
<p>$$\Box(\mathrm{ENABLED}\langle A \rangle_v \Rightarrow \Diamond \langle A \rangle_v)$$</p>
</li>
<li>
<p>Weaker formula $WF_v(A)$, defined to equal(3 种等价描述) &mdash; weak fairness on $A$</p>
<ul>
<li>
<p>If $A$ is enabled forever, then an $A$ step eventually occurs</p>
<p>$\Box(\Box \mathrm{ENABLED}\langle A \rangle_v \Rightarrow \Diamond \langle A \rangle_v)$</p>
</li>
<li>
<p>$A$ is infinitely often disabled, or infinitely many $A$ steps occur</p>
<p>$\Box \Diamond (\lnot \mathrm{ENABLED}\langle A \rangle_v) \lor \Box \Diamond \langle A \rangle_v$</p>
</li>
<li>
<p>If $A$ is eventually enabled forever, then infinitely many $A$ steps occur</p>
<p>$\Diamond \Box (\mathrm{ENABLED} \langle A \rangle_v) \Rightarrow \Box \Diamond \langle A \rangle_v$</p>
</li>
</ul>
</li>
</ul>
<h2 id="chapter-x-the-standard-modules">Chapter X: The Standard Modules</h2>
<h3 id="sequences-module">Sequences Module</h3>
<p>The Sequences module defines the following operators on sequences:</p>
<ul>
<li>
<p>$Seq(S)$</p>
<ul>
<li>The set of all sequence of elements of the set $S$</li>
<li>For example, $\langle 3, 7 \rangle$ is an element of $Seq(Nat)$</li>
</ul>
</li>
<li>
<p>$Head(S)$</p>
<ul>
<li>The first element of sequence $s$</li>
<li>For example, $Head(\langle 3, 7 \rangle)$ equals $3$</li>
</ul>
</li>
<li>
<p>$Tail(s)$</p>
<ul>
<li>The tail of sequence $s$, which consists of $s$ with its head removed</li>
<li>For example, $Tail(\langle 3, 7 \rangle)$ equals $\langle 7 \rangle$</li>
</ul>
</li>
<li>
<p>$Append(s, e)$</p>
<ul>
<li>The sequence obtained by appending element $e$ to the tail of sequence $s$</li>
<li>For example, $Append(\langle 3, 7 \rangle, 3)$ equals $\langle 3, 7, 3 \rangle$</li>
</ul>
</li>
<li>
<p>$s \circ t$</p>
<ul>
<li>The sequence obtained by concatenating the sequences $s$ and $t$</li>
<li>For example, $\langle 3, 7 \rangle \circ \langle 3 \rangle$ euqals $\langle 3, 7, 3 \rangle$</li>
</ul>
</li>
<li>
<p>$Len(s)$</p>
<ul>
<li>The length og sequence $s$.</li>
</ul>
</li>
<li>
<p>$SubSeq(s, m, n)$</p>
<ul>
<li>The subsequence $\langle s[m], s[m+1], \dots, s[n] \rangle$ consisting of the $m^{th}$ through $n^{th}$ elements of $s$</li>
<li>It is underfined if $m &lt; 1$ or $n &gt; Len(s)$, except that it equals the empty sequence if $m &gt; n$</li>
</ul>
</li>
<li>
<p>$SelectSeq(s, Test)$</p>
<ul>
<li>The subsequence of $s$ consisting of the elements $s[i]$ such that $Test(s[i])$ equals $\mathrm{TRUE}$</li>
</ul>
</li>
</ul>
<p><img src="/tla_sequence_module.png" alt="tla_sequence_module"></p>
<h3 id="finitesets-module">FiniteSets Module</h3>
<p>The FiniteSets module defines the following operators on set:</p>
<ul>
<li>
<p>$Cardinality(S)$</p>
<ul>
<li>The number of elements in set $S$, if $S$ is a finite set</li>
</ul>
</li>
<li>
<p>$IsFiniteSet(S)$</p>
<ul>
<li>True iff $S$ is a finite set</li>
</ul>
</li>
</ul>
<p><img src="/tla_finitesets_module.png" alt="tla_finitesets_module"></p>
<h3 id="bags-module">Bags Module</h3>
<p>A bag, also called a multiset, is a set that can contain multiple copies of the same element. A bag can have infinitely many elements, but only the finitely many copies of any single element.</p>
<p>The Bags module defines a bag to be a function whose range is a subset of the positive integers. The module defines the following operators:</p>
<ul>
<li>
<p>$IsABag(B)$</p>
<ul>
<li>True iff $B$ is a bag</li>
</ul>
</li>
<li>
<p>$BagToSet(B)$</p>
<ul>
<li>The set of elements of which bag $B$ contains at least one copy</li>
</ul>
</li>
<li>
<p>$SetToBag(S)$</p>
<ul>
<li>The bag that contains one copy of every element i nthe set $S$</li>
</ul>
</li>
<li>
<p>$BagIn(e, B)$</p>
<ul>
<li>True iff bag $B$ contains at least one copy of $e$.</li>
<li>$BagIn$ is the $\in$ operator for bags</li>
</ul>
</li>
<li>
<p>$EmptyBag$</p>
<ul>
<li>The bag containing no elements</li>
</ul>
</li>
<li>
<p>$CopiesIn(e, B)$</p>
<ul>
<li>The number of copies of $e$ in bag $B</li>
<li>it is equal to $0$ iff $BagIn(e, B)$ is false</li>
</ul>
</li>
<li>
<p>$B1 \oplus B2$</p>
<ul>
<li>The union of bags $B1$ and $B2$</li>
<li>The operator $\oplus$ satifies
$$CopiesIn(e, B1 \oplus B2) = CopiesIn(e, B1) + CopiesIn(e, B2)$$
for any $e$ and any bags $B1$ and $B2$</li>
</ul>
</li>
<li>
<p>$B1 \ominus B2$</p>
<ul>
<li>The bag $B1$ with the elements of $B2$ removed &mdash; that is, with one copy of an element removed from $B1$ for each copy of the same element in $B2$</li>
<li>If $B2$ has at least as many copies of $e$ as $B1$, then $B1 \ominus B2$ has no copies of $e$</li>
</ul>
</li>
<li>
<p>$BagUnion(S)$</p>
<ul>
<li>The bag union of all elements of the set $S$ of bags.</li>
<li>$BagUnion$ is the analog of $\mathrm{UNION}$ for bags.</li>
<li>For example, $BagUnion(\{B1, B2, B3\})$ equals $B1 \oplus B2 \oplus B3$</li>
</ul>
</li>
<li>
<p>$B1 \sqsubseteq B2$</p>
<ul>
<li>True iff, for all $e$, bag $B2$ has at least as many copies of $e$ as bag $B1$ does</li>
<li>$\sqsubseteq$ is the analog for bags of $\subseteq$</li>
</ul>
</li>
<li>
<p>$SubBag(B)$</p>
<ul>
<li>The set of all subbags of bag $B$</li>
<li>$SubBag$ is the analog of $\mathrm{SUBSET}$ for bags</li>
</ul>
</li>
<li>
<p>$BagOfAll(F, B)$</p>
<ul>
<li>It is thg bag that contains, for each element $e$ of bag $B$, one copy of $F(e)$ for every copy of $e$ in $B$</li>
<li>This defines a bag iff, for any value $v$, the set of $e$ in $B$ such that $F(e) = v$ is finite</li>
<li>The bag analog of the construct $\{F(x) : x \in B\}$</li>
</ul>
</li>
<li>
<p>$BagCardinality(B)$</p>
<ul>
<li>If $B$ is a finite bag (one such that $BagToSet(B)$ is a finite set), then this is its cardinality &mdash; the total number of copies of elements in $B$.</li>
<li>Its value is unspecified if $B$ is not a finite bag</li>
</ul>
</li>
</ul>
<p><img src="/tla_bags_module.png" alt="tal_bags_module"></p>
<h3 id="the-numbers-modules">The Numbers Modules</h3>
<p><img src="/tla_numbers_modules.png" alt="tla_numbers_module"></p>
<h3 id="realtime-module">RealTime Module</h3>
<p><img src="/tla_realtime_module.png" alt="tla_realtime_module"></p>
<h3 id="tlc-module">TLC Module</h3>
<p><img src="/tla_tlc_module.png" alt="tla_tlc_module"></p>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">765PRO.P</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
      2020-12-08
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://k-on.me/tags/tla&#43;/">TLA&#43;</a>
          
        </div>

      
      <nav class="post-nav">
        
        
          <a class="next" href="/post/tla_notes/">
            <span class="next-text nav-default">TLA&#43; notes</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  
  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="pro-765@qq.com" rel="me noopener" class="iconfont"
      title="email"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/yz1509" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://k-on.me/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2018 -
    2021
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        765PRO.P
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>









  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>












</body>
</html>
